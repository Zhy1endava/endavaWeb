<!DOCTYPE html>
<html lang="en">
<head>
    <title>Demo NestJS App</title>
    <link href="styles.css" rel="stylesheet" type="text/css">
    <script src="//code.jquery.com/jquery-1.12.4.min.js"></script>
    <script async="" data-cfasync="false" src="//media.aso1.net/js/code.min.js" type="text/javascript"></script>

    <script>
        var _aso = _aso || {};
        _aso.debug = true;
        // Array of ad div IDs
        var adDivs = ['ad01', 'ad02', 'ad03', 'ad04', 'ad05', 'ad06'];

        function refreshPage() {
            window.location.reload();
        }

        function clearAll() {
            adDivs.forEach(function (adDiv) {
                var div = $("#" + adDiv);
                div.empty(); // Clear the content of the div
                div.attr('class', 'ad-placeholder'); // Reset the class to 'ad-placeholder'
            });
        }

        $(function () {
            // Event listener for the search button click
            $('#search-button').on('click', function () {
                performSearch();
            });

            // Event listener for keypress in the search input field
            $('#search-bar').on('keypress', function (e) {
                // Check if the pressed key is 'Enter'
                if (e.which == 13) {
                    // Prevent the default action of the Enter key
                    e.preventDefault();

                    // Trigger the search button's click event
                    $('#search-button').click();
                }
            });

            // Function containing the search logic
            function performSearch() {

                // Capture the search input value
                var searchValue = $('#search-bar').val().trim();

                // Clear all before loading
                clearAll();

                // Load ads based on zone and keywords value
                adDivs.forEach(function (adDiv) {
                    _ASO.loadAd(adDiv, 108180, true, {
                        attr: {
                            // tags: ["hard_coded_tag"],
                            // bla_bla: ["random_tag"],
                            keywords: [searchValue]
                        }
                    });
                });
            }
        });
    </script>
</head>
<body>
<div class="container">
    <h1>Welcome to Demo NestJS App</h1>
    <p>This is a simple static page served by NestJS.</p>
    <p>This is a proof of concept to preview how ads will be displayed on a webpage.</p>

    <div class="search-container">
        <label for="search-bar">Product search dummy</label>
        <input id="search-bar" placeholder="Search..." type="text">
        <button id="search-button">Search</button>
        <button onclick="refreshPage()">Refresh Page</button>
        <div class="info-box">
            Only specific search 'keywords' will trigger ads (e.g., "white sneakers", "regular ads").
        </div>
    </div>

    <div class="ads-container">
        <!-- Ad01 -->
        <div class="ad-placeholder" id='ad01'>
        </div>
        <!-- Ad02 -->
        <div class="ad-placeholder" id='ad02'>
        </div>
        <!-- Ad03 -->
        <div class="ad-placeholder" id='ad03'>
        </div>
        <!-- Ad04 -->
        <div class="ad-placeholder" id='ad04'>
        </div>
        <!-- Ad05 -->
        <div class="ad-placeholder" id='ad05'>
        </div>
        <!-- Ad06 -->
        <div class="ad-placeholder" id='ad06'>
        </div>
    </div>
</div>
</body>
</html>
