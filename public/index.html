<!DOCTYPE html>
<html lang="en">
<head>
    <title>ChaChing NestJS App</title>
    <link href="styles.css" rel="stylesheet" type="text/css">
    <script src="//code.jquery.com/jquery-1.12.4.min.js"></script>
    <script data-cfasync="false" async="" type="text/javascript" src="//media.aso1.net/js/code.min.js"></script>
    <script>
        var _aso = _aso || {};
        _aso.debug = true;
        // Array of ad div IDs
        var adDivs = ['ad01', 'ad02', 'ad03', 'ad04', 'ad05', 'ad06'];

        function refreshPage() {
            window.location.reload();
        }

        function clearAll() {
            adDivs.forEach(function(adDiv) {
                var div = $("#" + adDiv);
                div.empty(); // Clear the content of the div
                div.attr('class', 'ad-placeholder'); // Reset the class to 'ad-placeholder'
            });
        }

        $(function () {
            // Event listener for the search button click
            $('#search-button').on('click', function () {
                performSearch();
            });

            // Event listener for keypress in the search input field
            $('#search-bar').on('keypress', function (e) {
                // Check if the pressed key is 'Enter'
                if (e.which == 13) {
                    // Prevent the default action of the Enter key
                    e.preventDefault();

                    // Trigger the search button's click event
                    $('#search-button').click();
                }
            });

            // Function containing the search logic
            function performSearch() {

                // Capture the search input value
                var searchValue = $('#search-bar').val().trim();

                // Determine the zoneId based on the search value
                var zoneId;
                if (searchValue === '') {
                    zoneId = 111111; // random Zone ID when empty
                } else if (searchValue.toLowerCase() === 'white sneakers') {
                    zoneId = 108397; // Zone ID for white sneakers
                } else {
                    zoneId = 108180; // Zone ID for everything else
                }

                // Clear all before loading
                clearAll();

                // Load ads based on zone and keywords value
                adDivs.forEach(function(adDiv) {
                    _ASO.loadAd(adDiv, zoneId, true, {
                        attr: {
                            tags: ["hard_coded_tag"],
                            bla_bla: ["random_tag"],
                            keywords: [searchValue]
                        }
                    });
                });
            }
        });
    </script>
</head>
<body>
<div class="container">
    <h1>Welcome to ChaChing NestJS App</h1>
    <p>This is a simple static page served by NestJS.</p>
    <p>This is a proof of concept to preview how ads will be displayed on a webpage.</p>

    <div class="search-container">
        <label for="search-bar">Search bar dummy</label>
        <input id="search-bar" placeholder="Search..." type="text">
        <button id="search-button" >Search</button>
        <button onclick="refreshPage()">Refresh Page</button>
    </div>

    <div class="ads-container">
        <!-- Ad01 -->
        <div id='ad01' class="ad-placeholder">
        </div>
        <!-- Ad02 -->
        <div id='ad02' class="ad-placeholder">
        </div>
        <!-- Ad03 -->
        <div id='ad03' class="ad-placeholder">
        </div>
        <!-- Ad04 -->
        <div id='ad04' class="ad-placeholder">
        </div>
        <!-- Ad05 -->
        <div id='ad05' class="ad-placeholder">
        </div>
        <!-- Ad06 -->
        <div id='ad06' class="ad-placeholder">
        </div>
    </div>
</div>
</body>
</html>
